# Add amounts
send_gold_add_1 = {
	scope = character
	effect = {
		if = {
			limit = { has_variable = send_gold_amount }
			change_variable = { name = send_gold_amount add = 1 }
			# Cap at current gold
			if = {
				limit = { var:send_gold_amount > gold }
				set_variable = { name = send_gold_amount value = gold }
			}
		}
	}
}

send_gold_add_10 = {
	scope = character
	effect = {
		if = {
			limit = { has_variable = send_gold_amount }
			change_variable = { name = send_gold_amount add = 10 }
			if = {
				limit = { var:send_gold_amount > gold }
				set_variable = { name = send_gold_amount value = gold }
			}
		}
	}
}

send_gold_add_100 = {
	scope = character
	effect = {
		if = {
			limit = { has_variable = send_gold_amount }
			change_variable = { name = send_gold_amount add = 100 }
			if = {
				limit = { var:send_gold_amount > gold }
				set_variable = { name = send_gold_amount value = gold }
			}
		}
	}
}

# Subtract amounts
send_gold_sub_1 = {
	scope = character
	effect = {
		if = {
			limit = { has_variable = send_gold_amount }
			change_variable = { name = send_gold_amount add = -1 }
			if = {
				limit = { var:send_gold_amount < 1 }
				set_variable = { name = send_gold_amount value = 1 }
			}
		}
	}
}

send_gold_sub_10 = {
	scope = character
	effect = {
		if = {
			limit = { has_variable = send_gold_amount }
			change_variable = { name = send_gold_amount add = -10 }
			if = {
				limit = { var:send_gold_amount < 1 }
				set_variable = { name = send_gold_amount value = 1 }
			}
		}
	}
}

send_gold_sub_100 = {
	scope = character
	effect = {
		if = {
			limit = { has_variable = send_gold_amount }
			change_variable = { name = send_gold_amount add = -100 }
			if = {
				limit = { var:send_gold_amount < 1 }
				set_variable = { name = send_gold_amount value = 1 }
			}
		}
	}
}

# Set to max
send_gold_set_max = {
	scope = character
	effect = {
		set_variable = { name = send_gold_amount value = gold }
	}
}

# Execute transfer
send_gold_execute = {
	scope = character
	
	is_valid = {
		has_variable = send_gold_target
		has_variable = send_gold_amount
		var:send_gold_amount >= 1
		gold >= var:send_gold_amount
	}
	
	effect = {
		# Transfer gold
		var:send_gold_target = {
			add_gold = root.var:send_gold_amount
		}
		remove_short_term_gold = var:send_gold_amount
		
		# Clean up
		remove_variable = send_gold_target
		remove_variable = send_gold_amount
	}
}

# Cancel - close window
send_gold_cancel = {
	scope = character
	effect = {
		if = {
			limit = { has_variable = send_gold_target }
			remove_variable = send_gold_target
		}
		if = {
			limit = { has_variable = send_gold_amount }
			remove_variable = send_gold_amount
		}
	}
}

# Check if window should be visible
send_gold_is_open = {
	scope = character
	is_shown = {
		has_variable = send_gold_target
	}
}

# Check if can send
send_gold_can_execute = {
	scope = character
	is_valid = {
		has_variable = send_gold_target
		has_variable = send_gold_amount
		var:send_gold_amount >= 1
		gold >= var:send_gold_amount
	}
}
